print_progress_plot = function(gnt,campus){
complete_plot <- subset(gnt,select=c("Group","Status"))
gtitle = paste(campus," Completion Status")
x <-c("Not Started","In Progress","Completed")
complete_plot <- complete_plot %>% mutate(Status =  factor(Status, levels = x)) %>% arrange(Status)
ggplot(complete_plot,aes(y=1)) +
geom_bar(aes(fill=Status), position="fill", width = 0.1,) +
scale_x_continuous(expand=expansion(0),labels = scales::percent_format()) +
theme(axis.title.y = element_blank(),
axis.ticks.y = element_blank(),
axis.text.y = element_blank()) +
ggtitle(gtitle) +
ylim( 0.9, 1.1) +
scale_fill_manual(values=c("#cd6600",
"#BF9000",
"#2E75B6"))
}
campus = "Berkeley"
gnt_berkeley<-create_gantt_table(total_xcl,campus)
print_progress_plot(gnt_berkeley,campus)
campus = "UC Davis"
gnt_ucdavis<-create_gantt_table(total_xcl,campus)
print_progress_plot(gnt_ucdavis,campus)
campus = "Berkeley"
gnt_berkeley<-create_gantt_table(total_xcl,campus)
print_progress_plot(gnt_berkeley,campus)
campus = "UC Davis"
gnt_ucdavis<-create_gantt_table(total_xcl,campus)
print_progress_plot(gnt_ucdavis,campus)
campus = "UC Irvine"
gnt_ucirvine<-create_gantt_table(total_xcl,campus)
total_xcl<-read_excel("UC_HPR.xlsx", sheet = "Contacts")
campus = "UC Davis"
create_gantt_table = function(total_xcl,campus) {
xcl<-filter(total_xcl, Campus==campus)
today_Date <- Sys.Date()
hs <- c("Item","Group","Status","Start","End")
fc <- xcl$ShortName
pc <- as.character(1:length(fc))
sc <- case_when(is.na(xcl$P_Interview) ~ "Not Started",xcl$P_Interview<=today_Date ~ "Completed", xcl$P_Interview>today_Date ~ "In Progress")
tc <- xcl$P_contact
hc <- xcl$P_Interview
gnt <- data.frame(pc,fc,sc,tc,hc)
colnames(gnt) <- hs
gnt <- gnt %>% add_row(Item="3",Group="EHS",Status=case_when(is.na(xcl$R_Interview[1]) ~ "Not Started",xcl$E_Interview[1]<=today_Date ~ "Completed", xcl$E_Interview[1]>today_Date ~ "In Progress"),Start=xcl$E_Contact[1],End=xcl$E_Interview[1])
gnt <- gnt %>% add_row(Item="4",Group="Risk",Status=case_when(is.na(xcl$R_Interview[1]) ~ "Not Started",xcl$R_Interview[1]<=today_Date ~ "Completed", xcl$R_Interview[1]>today_Date ~ "In Progress"),Start=xcl$R_Contact[1],End=xcl$R_Interview[1])
gnt <- gnt %>% add_row(Item="5",Group="Faculty",Status=case_when(is.na(xcl$F_Interview[1]) ~ "Not Started",xcl$F_Interview[1]<=today_Date ~ "Completed", xcl$F_Interview[1]>today_Date ~ "In Progress"),Start=xcl$F_Contact[1],End=xcl$F_Interview[1])
gnt <- gnt %>% add_row(Item="6",Group="Dean of Engineering",Status=case_when(is.na(xcl$D_Interview[1]) ~ "Not Started",xcl$D_Interview[1]<=today_Date ~ "Completed", xcl$D_Interview[1]>today_Date ~ "In Progress"),Start=xcl$D_Contact[1],End=xcl$D_Interview[1])
return (gnt)
}
print_campus_gantt = function(gnt) {
today_Date <- Sys.Date()
start_Date <-as.Date(min(gsub("\\.","-",na.omit(gnt$Start))))
end_Date <- as.Date(max(gsub("\\.","-",na.omit(gnt$End))))+weeks(1)
gantt_plot <- na.omit(gnt)
gantt_plot["End"][is.na(gantt_plot["End"])]<-end_Date
gantt_plot<-gantt_plot[order(as.Date(gantt_plot$Start,format="%Y.%m.%d")),]
acts<-unique(as.character(gantt_plot$Group))
els <-unique(as.character(gantt_plot$Status))
actcols <- c("#548235", "#2E75B6", "#BF9000", "#7030A0", "#cd6600")
g.gantt_plot <- gather(gantt_plot, "state", "date", 4:5) %>% mutate(date = as.Date(date), Group=factor(Group, acts[length(acts):1]), Status=factor(Status, els))
ggplot(g.gantt_plot, aes(date, Group, colour = Status, group=Item)) +
geom_line(linewidth = 10) +
scale_color_manual(values=actcols, name="Key") +
labs(x="Date", y=NULL, title=campus) +
scale_x_date(date_labels = "%b %d")+
theme_gray(base_size=14)+
geom_vline(xintercept = today_Date,linetype = "dashed",
colour = "red",
linewidth = 1.5)
}
print_progress_plot = function(gnt,campus){
complete_plot <- subset(gnt,select=c("Group","Status"))
gtitle = paste(campus," Completion Status")
x <-c("Not Started","In Progress","Completed")
complete_plot <- complete_plot %>% mutate(Status =  factor(Status, levels = x)) %>% arrange(Status)
ggplot(complete_plot,aes(y=1)) +
geom_bar(aes(fill=Status), position="fill", width = 0.1,) +
scale_x_continuous(expand=expansion(0),labels = scales::percent_format()) +
theme(axis.title.y = element_blank(),
axis.ticks.y = element_blank(),
axis.text.y = element_blank()) +
ggtitle(gtitle) +
ylim( 0.9, 1.1) +
scale_fill_manual(values=c("#cd6600",
"#BF9000",
"#2E75B6"))
}
campus = "Berkeley"
gnt_berkeley<-create_gantt_table(total_xcl,campus)
print_progress_plot(gnt_berkeley,campus)
campus = "UC Davis"
gnt_ucdavis<-create_gantt_table(total_xcl,campus)
print_progress_plot(gnt_ucdavis,campus)
campus = "UC Irvine"
gnt_ucirvine<-create_gantt_table(total_xcl,campus)
print_progress_plot(gnt_irvine,campus)
campus = "Berkeley"
gnt_berkeley<-create_gantt_table(total_xcl,campus)
print_progress_plot(gnt_berkeley,campus)
campus = "UC Davis"
gnt_ucdavis<-create_gantt_table(total_xcl,campus)
print_progress_plot(gnt_ucdavis,campus)
campus = "UC Irvine"
gnt_ucirvine<-create_gantt_table(total_xcl,campus)
print_progress_plot(gnt_ucirvine,campus)
total_xcl<-read_excel("UC_HPR.xlsx", sheet = "Contacts")
campus = "UC Davis"
create_gantt_table = function(total_xcl,campus) {
xcl<-filter(total_xcl, Campus==campus)
today_Date <- Sys.Date()
hs <- c("Item","Group","Status","Start","End")
fc <- xcl$ShortName
pc <- as.character(1:length(fc))
sc <- case_when(is.na(xcl$P_Interview) ~ "Not Started",xcl$P_Interview<=today_Date ~ "Completed", xcl$P_Interview>today_Date ~ "In Progress")
tc <- xcl$P_contact
hc <- xcl$P_Interview
gnt <- data.frame(pc,fc,sc,tc,hc)
colnames(gnt) <- hs
gnt <- gnt %>% add_row(Item="3",Group="EHS",Status=case_when(is.na(xcl$R_Interview[1]) ~ "Not Started",xcl$E_Interview[1]<=today_Date ~ "Completed", xcl$E_Interview[1]>today_Date ~ "In Progress"),Start=xcl$E_Contact[1],End=xcl$E_Interview[1])
gnt <- gnt %>% add_row(Item="4",Group="Risk",Status=case_when(is.na(xcl$R_Interview[1]) ~ "Not Started",xcl$R_Interview[1]<=today_Date ~ "Completed", xcl$R_Interview[1]>today_Date ~ "In Progress"),Start=xcl$R_Contact[1],End=xcl$R_Interview[1])
gnt <- gnt %>% add_row(Item="5",Group="Faculty",Status=case_when(is.na(xcl$F_Interview[1]) ~ "Not Started",xcl$F_Interview[1]<=today_Date ~ "Completed", xcl$F_Interview[1]>today_Date ~ "In Progress"),Start=xcl$F_Contact[1],End=xcl$F_Interview[1])
gnt <- gnt %>% add_row(Item="6",Group="Dean of Engineering",Status=case_when(is.na(xcl$D_Interview[1]) ~ "Not Started",xcl$D_Interview[1]<=today_Date ~ "Completed", xcl$D_Interview[1]>today_Date ~ "In Progress"),Start=xcl$D_Contact[1],End=xcl$D_Interview[1])
return (gnt)
}
print_campus_gantt = function(gnt) {
today_Date <- Sys.Date()
start_Date <-as.Date(min(gsub("\\.","-",na.omit(gnt$Start))))
end_Date <- as.Date(max(gsub("\\.","-",na.omit(gnt$End))))+weeks(1)
gantt_plot <- na.omit(gnt)
gantt_plot["End"][is.na(gantt_plot["End"])]<-end_Date
gantt_plot<-gantt_plot[order(as.Date(gantt_plot$Start,format="%Y.%m.%d")),]
acts<-unique(as.character(gantt_plot$Group))
els <-unique(as.character(gantt_plot$Status))
actcols <- c("#548235", "#2E75B6", "#BF9000", "#7030A0", "#cd6600")
g.gantt_plot <- gather(gantt_plot, "state", "date", 4:5) %>% mutate(date = as.Date(date), Group=factor(Group, acts[length(acts):1]), Status=factor(Status, els))
ggplot(g.gantt_plot, aes(date, Group, colour = Status, group=Item)) +
geom_line(linewidth = 10) +
scale_color_manual(values=actcols, name="Key") +
labs(x="Date", y=NULL, title=campus) +
scale_x_date(date_labels = "%b %d")+
theme_gray(base_size=14)+
geom_vline(xintercept = today_Date,linetype = "dashed",
colour = "red",
linewidth = 1.5)
}
print_progress_plot = function(gnt,campus){
complete_plot <- subset(gnt,select=c("Group","Status"))
gtitle = paste(campus," Completion Status")
x <-c("Not Started","In Progress","Completed")
complete_plot <- complete_plot %>% mutate(Status =  factor(Status, levels = x)) %>% arrange(Status)
ggplot(complete_plot,aes(y=1)) +
geom_bar(aes(fill=Status), position="fill", width = 0.1,) +
scale_x_continuous(expand=expansion(0),labels = scales::percent_format()) +
theme(axis.title.y = element_blank(),
axis.ticks.y = element_blank(),
axis.text.y = element_blank()) +
ggtitle(gtitle) +
ylim( 0.9, 1.1) +
scale_fill_manual(values=c("#cd6600",
"#BF9000",
"#2E75B6"))
}
campus = "Berkeley"
gnt_berkeley<-create_gantt_table(total_xcl,campus)
print_progress_plot(gnt_berkeley,campus)
campus = "UC Davis"
gnt_ucdavis<-create_gantt_table(total_xcl,campus)
print_progress_plot(gnt_ucdavis,campus)
campus = "UC Irvine"
gnt_ucirvine<-create_gantt_table(total_xcl,campus)
print_progress_plot(gnt_ucirvine,campus)
total_xcl<-read_excel("UC_HPR.xlsx", sheet = "Contacts")
library(tidyverse)
library(readxl)
total_xcl<-read_excel("UC_HPR.xlsx", sheet = "Contacts")
campus = "UC Davis"
create_gantt_table = function(total_xcl,campus) {
xcl<-filter(total_xcl, Campus==campus)
today_Date <- Sys.Date()
hs <- c("Item","Group","Status","Start","End")
fc <- xcl$ShortName
pc <- as.character(1:length(fc))
sc <- case_when(is.na(xcl$P_Interview) ~ "Not Started",xcl$P_Interview<=today_Date ~ "Completed", xcl$P_Interview>today_Date ~ "In Progress")
tc <- xcl$P_contact
hc <- xcl$P_Interview
gnt <- data.frame(pc,fc,sc,tc,hc)
colnames(gnt) <- hs
gnt <- gnt %>% add_row(Item="3",Group="EHS",Status=case_when(is.na(xcl$R_Interview[1]) ~ "Not Started",xcl$E_Interview[1]<=today_Date ~ "Completed", xcl$E_Interview[1]>today_Date ~ "In Progress"),Start=xcl$E_Contact[1],End=xcl$E_Interview[1])
gnt <- gnt %>% add_row(Item="4",Group="Risk",Status=case_when(is.na(xcl$R_Interview[1]) ~ "Not Started",xcl$R_Interview[1]<=today_Date ~ "Completed", xcl$R_Interview[1]>today_Date ~ "In Progress"),Start=xcl$R_Contact[1],End=xcl$R_Interview[1])
gnt <- gnt %>% add_row(Item="5",Group="Faculty",Status=case_when(is.na(xcl$F_Interview[1]) ~ "Not Started",xcl$F_Interview[1]<=today_Date ~ "Completed", xcl$F_Interview[1]>today_Date ~ "In Progress"),Start=xcl$F_Contact[1],End=xcl$F_Interview[1])
gnt <- gnt %>% add_row(Item="6",Group="Dean of Engineering",Status=case_when(is.na(xcl$D_Interview[1]) ~ "Not Started",xcl$D_Interview[1]<=today_Date ~ "Completed", xcl$D_Interview[1]>today_Date ~ "In Progress"),Start=xcl$D_Contact[1],End=xcl$D_Interview[1])
return (gnt)
}
print_campus_gantt = function(gnt) {
today_Date <- Sys.Date()
start_Date <-as.Date(min(gsub("\\.","-",na.omit(gnt$Start))))
end_Date <- as.Date(max(gsub("\\.","-",na.omit(gnt$End))))+weeks(1)
gantt_plot <- na.omit(gnt)
gantt_plot["End"][is.na(gantt_plot["End"])]<-end_Date
gantt_plot<-gantt_plot[order(as.Date(gantt_plot$Start,format="%Y.%m.%d")),]
acts<-unique(as.character(gantt_plot$Group))
els <-unique(as.character(gantt_plot$Status))
actcols <- c("#548235", "#2E75B6", "#BF9000", "#7030A0", "#cd6600")
g.gantt_plot <- gather(gantt_plot, "state", "date", 4:5) %>% mutate(date = as.Date(date), Group=factor(Group, acts[length(acts):1]), Status=factor(Status, els))
ggplot(g.gantt_plot, aes(date, Group, colour = Status, group=Item)) +
geom_line(linewidth = 10) +
scale_color_manual(values=actcols, name="Key") +
labs(x="Date", y=NULL, title=campus) +
scale_x_date(date_labels = "%b %d")+
theme_gray(base_size=14)+
geom_vline(xintercept = today_Date,linetype = "dashed",
colour = "red",
linewidth = 1.5)
}
print_progress_plot = function(gnt,campus){
complete_plot <- subset(gnt,select=c("Group","Status"))
gtitle = paste(campus," Completion Status")
x <-c("Not Started","In Progress","Completed")
complete_plot <- complete_plot %>% mutate(Status =  factor(Status, levels = x)) %>% arrange(Status)
ggplot(complete_plot,aes(y=1)) +
geom_bar(aes(fill=Status), position="fill", width = 0.1,) +
scale_x_continuous(expand=expansion(0),labels = scales::percent_format()) +
theme(axis.title.y = element_blank(),
axis.ticks.y = element_blank(),
axis.text.y = element_blank()) +
ggtitle(gtitle) +
ylim( 0.9, 1.1) +
scale_fill_manual(values=c("#cd6600",
"#BF9000",
"#2E75B6"))
}
xcl<-filter(total_xcl, ShortName="SEB")
xcl<-filter(total_xcl, ShortName=="SEB")
tabl <- "
| Tables        | Are           | Cool  |
|---------------|:-------------:|------:|
| col 3 is      | right-aligned | $1600 |
| col 2 is      | centered      |   $12 |
| zebra stripes | are neat      |    $1 |
"
cat(tabl) # output the table in a format good for HTML/PDF/docx conversion
xcl<-filter(total_xcl, ShortName=="SEB")
tabl <- "
| Tables        | Are           | Cool  |
|---------------|:-------------:|------:|
| col 3 is      | right-aligned | $1600 |
| col 2 is      | centered      |   $12 |
| zebra stripes | are neat      |    $1 |
"
str_replace_all(tabl,"col 3 is",xcl$Name)
cat(tabl) # output the table in a format good for HTML/PDF/docx conversion
xcl<-filter(total_xcl, ShortName=="SEB")
tabl <- "
| Tables        | Are           | Cool  |
|---------------|:-------------:|------:|
| col 3 is      | right-aligned | $1600 |
| col 2 is      | centered      |   $12 |
| zebra stripes | are neat      |    $1 |
"
tabl<-str_replace_all(tabl,"col 3 is",xcl$Name)
cat(tabl) # output the table in a format good for HTML/PDF/docx conversion
xcl<-filter(total_xcl, ShortName=="SEB")
tabl <- "
| Name        | Campus           |
|---------------|:-------------:|
| Website  | Wadd      |
| Email | eAdd      |
| President | pres |
"
tabl<-str_replace_all(tabl,"Name",xcl$Name)
tabl<-str_replace_all(tabl,"Campus",xcl$Campus)
cat(tabl) # output the table in a format good for HTML/PDF/docx conversion
xcl<-filter(total_xcl, ShortName=="SEB")
tabl <- "
| Name        | Campus           |
|---------------|:-------------:|
| Website  | Wadd      |
| Email | eAdd      |
| President | pres |
"
tabl<-str_replace_all(tabl,"Name",xcl$Name)
tabl<-str_replace_all(tabl,"Campus",xcl$Campus)
tabl<-str_replace_all(tabl,"Wadd",xcl$Webpage)
cat(tabl) # output the table in a format good for HTML/PDF/docx conversion
xcl<-filter(total_xcl, ShortName=="SEB")
tabl <- "
| Name        | Campus           |
|---------------:|:-------------|
| Website  | Wadd      |
| Email | eAdd      |
| President | pres |
"
tabl<-str_replace_all(tabl,"Name",xcl$Name)
tabl<-str_replace_all(tabl,"Campus",xcl$Campus)
tabl<-str_replace_all(tabl,"Wadd",xcl$Webpage)
tabl<-str_replace_all(tabl,"eAdd",xcl$Contact)
tabl<-str_replace_all(tabl,"pres",xcl$President)
cat(tabl) # output the table in a format good for HTML/PDF/docx conversion
shortname="APL"
print_club_detail(total_xcl,shortname)
shortname="SEB"
print_club_detail(total_xcl,shortname)
total_xcl<-read_excel("UC_HPR.xlsx", sheet = "Contacts")
campus = "UC Davis"
create_gantt_table = function(total_xcl,campus) {
xcl<-filter(total_xcl, Campus==campus)
today_Date <- Sys.Date()
hs <- c("Item","Group","Status","Start","End")
fc <- xcl$ShortName
pc <- as.character(1:length(fc))
sc <- case_when(is.na(xcl$P_Interview) ~ "Not Started",xcl$P_Interview<=today_Date ~ "Completed", xcl$P_Interview>today_Date ~ "In Progress")
tc <- xcl$P_contact
hc <- xcl$P_Interview
gnt <- data.frame(pc,fc,sc,tc,hc)
colnames(gnt) <- hs
gnt <- gnt %>% add_row(Item="3",Group="EHS",Status=case_when(is.na(xcl$R_Interview[1]) ~ "Not Started",xcl$E_Interview[1]<=today_Date ~ "Completed", xcl$E_Interview[1]>today_Date ~ "In Progress"),Start=xcl$E_Contact[1],End=xcl$E_Interview[1])
gnt <- gnt %>% add_row(Item="4",Group="Risk",Status=case_when(is.na(xcl$R_Interview[1]) ~ "Not Started",xcl$R_Interview[1]<=today_Date ~ "Completed", xcl$R_Interview[1]>today_Date ~ "In Progress"),Start=xcl$R_Contact[1],End=xcl$R_Interview[1])
gnt <- gnt %>% add_row(Item="5",Group="Faculty",Status=case_when(is.na(xcl$F_Interview[1]) ~ "Not Started",xcl$F_Interview[1]<=today_Date ~ "Completed", xcl$F_Interview[1]>today_Date ~ "In Progress"),Start=xcl$F_Contact[1],End=xcl$F_Interview[1])
gnt <- gnt %>% add_row(Item="6",Group="Dean of Engineering",Status=case_when(is.na(xcl$D_Interview[1]) ~ "Not Started",xcl$D_Interview[1]<=today_Date ~ "Completed", xcl$D_Interview[1]>today_Date ~ "In Progress"),Start=xcl$D_Contact[1],End=xcl$D_Interview[1])
return (gnt)
}
print_campus_gantt = function(gnt,campus) {
today_Date <- Sys.Date()
start_Date <-as.Date(min(gsub("\\.","-",na.omit(gnt$Start))))
end_Date <- as.Date(max(gsub("\\.","-",na.omit(gnt$End))))+weeks(1)
gantt_plot <- na.omit(gnt)
gantt_plot["End"][is.na(gantt_plot["End"])]<-end_Date
gantt_plot<-gantt_plot[order(as.Date(gantt_plot$Start,format="%Y.%m.%d")),]
acts<-unique(as.character(gantt_plot$Group))
els <-unique(as.character(gantt_plot$Status))
actcols <- c("#548235", "#2E75B6", "#BF9000", "#7030A0", "#cd6600")
g.gantt_plot <- gather(gantt_plot, "state", "date", 4:5) %>% mutate(date = as.Date(date), Group=factor(Group, acts[length(acts):1]), Status=factor(Status, els))
ggplot(g.gantt_plot, aes(date, Group, colour = Status, group=Item)) +
geom_line(linewidth = 10) +
scale_color_manual(values=actcols, name="Key") +
labs(x="Date", y=NULL, title=campus) +
scale_x_date(date_labels = "%b %d")+
theme_gray(base_size=14)+
geom_vline(xintercept = today_Date,linetype = "dashed",
colour = "red",
linewidth = 1.5)
}
print_progress_plot = function(gnt,campus){
complete_plot <- subset(gnt,select=c("Group","Status"))
gtitle = paste(campus," Completion Status")
x <-c("Not Started","In Progress","Completed")
complete_plot <- complete_plot %>% mutate(Status =  factor(Status, levels = x)) %>% arrange(Status)
ggplot(complete_plot,aes(y=1)) +
geom_bar(aes(fill=Status), position="fill", width = 0.1,) +
scale_x_continuous(expand=expansion(0),labels = scales::percent_format()) +
theme(axis.title.y = element_blank(),
axis.ticks.y = element_blank(),
axis.text.y = element_blank()) +
ggtitle(gtitle) +
ylim( 0.9, 1.1) +
scale_fill_manual(values=c("#cd6600",
"#BF9000",
"#2E75B6"))
}
print_club_detail = function(total_xcl,shortname) {
xcl<-filter(total_xcl, ShortName==shortname)
tabl <- "
| Name        | Campus           |
|---------------:|:-------------|
| Website  | Wadd      |
| Email | eAdd      |
| President | pres |
"
tabl<-str_replace_all(tabl,"Name",xcl$Name)
tabl<-str_replace_all(tabl,"Campus",xcl$Campus)
tabl<-str_replace_all(tabl,"Wadd",xcl$Webpage)
tabl<-str_replace_all(tabl,"eAdd",xcl$Contact)
tabl<-str_replace_all(tabl,"pres",xcl$President)
cat(tabl) # output the table in a format good for HTML/PDF/docx conversion
}
shortname="SEB"
print_club_detail(total_xcl,shortname)
shortname="APL"
print_club_detail(total_xcl,shortname)
View(total_xcl)
shortname="APL"
print_club_detail(total_xcl,shortname)
xcl<-filter(total_xcl, ShortName==shortname)
tabl <- "
| Name        | Campus           |
|---------------:|:-------------|
| Website  | Wadd      |
| Email | eAdd      |
| President | pres |
"
tabl<-str_replace_all(tabl,"Name",xcl$Name)
tabl<-str_replace_all(tabl,"Campus",xcl$Campus)
tabl<-str_replace_all(tabl,"Wadd",xcl$Webpage)
tabl<-str_replace_all(tabl,"eAdd",xcl$Contact)
tabl<-str_replace_all(tabl,"pres",xcl$President)
View(xcl)
shortname="APL"
print_club_detail(total_xcl,shortname)
xcl<-filter(total_xcl, ShortName==shortname)
tabl <- "
| Name        | Campus           |
|---------------:|:-------------|
| Website  | Wadd      |
| Email | eAdd      |
| President | pres |
"
tabl<-str_replace_all(tabl,"Name",xcl$Name)
tabl<-str_replace_all(tabl,"Campus",xcl$Campus)
tabl<-str_replace_all(tabl,"Wadd",xcl$Webpage)
tabl<-str_replace_all(tabl,"eAdd",xcl$Contact)
#tabl<-str_replace_all(tabl,"pres",xcl$President)
shortname="APL"
print_club_detail(total_xcl,shortname)
xcl<-filter(total_xcl, ShortName==shortname)
tabl <- "
| Name        | Campus           |
|---------------:|:-------------|
| Website  | Wadd      |
| Email | eAdd      |
| President | pres |
"
tabl<-str_replace_all(tabl,"Name",xcl$Name)
tabl<-str_replace_all(tabl,"Campus",xcl$Campus)
tabl<-str_replace_all(tabl,"Wadd",xcl$Webpage)
tabl<-str_replace_all(tabl,"eAdd",xcl$Contact)
if (!is.na(xcl$President)) {
tabl<-str_replace_all(tabl,"pres",xcl$President)
} else {
tabl<-str_replace_all(tabl,"pres","TBD")
}
total_xcl<-read_excel("UC_HPR.xlsx", sheet = "Contacts")
campus = "UC Davis"
create_gantt_table = function(total_xcl,campus) {
xcl<-filter(total_xcl, Campus==campus)
today_Date <- Sys.Date()
hs <- c("Item","Group","Status","Start","End")
fc <- xcl$ShortName
pc <- as.character(1:length(fc))
sc <- case_when(is.na(xcl$P_Interview) ~ "Not Started",xcl$P_Interview<=today_Date ~ "Completed", xcl$P_Interview>today_Date ~ "In Progress")
tc <- xcl$P_contact
hc <- xcl$P_Interview
gnt <- data.frame(pc,fc,sc,tc,hc)
colnames(gnt) <- hs
gnt <- gnt %>% add_row(Item="3",Group="EHS",Status=case_when(is.na(xcl$R_Interview[1]) ~ "Not Started",xcl$E_Interview[1]<=today_Date ~ "Completed", xcl$E_Interview[1]>today_Date ~ "In Progress"),Start=xcl$E_Contact[1],End=xcl$E_Interview[1])
gnt <- gnt %>% add_row(Item="4",Group="Risk",Status=case_when(is.na(xcl$R_Interview[1]) ~ "Not Started",xcl$R_Interview[1]<=today_Date ~ "Completed", xcl$R_Interview[1]>today_Date ~ "In Progress"),Start=xcl$R_Contact[1],End=xcl$R_Interview[1])
gnt <- gnt %>% add_row(Item="5",Group="Faculty",Status=case_when(is.na(xcl$F_Interview[1]) ~ "Not Started",xcl$F_Interview[1]<=today_Date ~ "Completed", xcl$F_Interview[1]>today_Date ~ "In Progress"),Start=xcl$F_Contact[1],End=xcl$F_Interview[1])
gnt <- gnt %>% add_row(Item="6",Group="Dean of Engineering",Status=case_when(is.na(xcl$D_Interview[1]) ~ "Not Started",xcl$D_Interview[1]<=today_Date ~ "Completed", xcl$D_Interview[1]>today_Date ~ "In Progress"),Start=xcl$D_Contact[1],End=xcl$D_Interview[1])
return (gnt)
}
print_campus_gantt = function(gnt,campus) {
today_Date <- Sys.Date()
start_Date <-as.Date(min(gsub("\\.","-",na.omit(gnt$Start))))
end_Date <- as.Date(max(gsub("\\.","-",na.omit(gnt$End))))+weeks(1)
gantt_plot <- na.omit(gnt)
gantt_plot["End"][is.na(gantt_plot["End"])]<-end_Date
gantt_plot<-gantt_plot[order(as.Date(gantt_plot$Start,format="%Y.%m.%d")),]
acts<-unique(as.character(gantt_plot$Group))
els <-unique(as.character(gantt_plot$Status))
actcols <- c("#548235", "#2E75B6", "#BF9000", "#7030A0", "#cd6600")
g.gantt_plot <- gather(gantt_plot, "state", "date", 4:5) %>% mutate(date = as.Date(date), Group=factor(Group, acts[length(acts):1]), Status=factor(Status, els))
ggplot(g.gantt_plot, aes(date, Group, colour = Status, group=Item)) +
geom_line(linewidth = 10) +
scale_color_manual(values=actcols, name="Key") +
labs(x="Date", y=NULL, title=campus) +
scale_x_date(date_labels = "%b %d")+
theme_gray(base_size=14)+
geom_vline(xintercept = today_Date,linetype = "dashed",
colour = "red",
linewidth = 1.5)
}
print_progress_plot = function(gnt,campus){
complete_plot <- subset(gnt,select=c("Group","Status"))
gtitle = paste(campus," Completion Status")
x <-c("Not Started","In Progress","Completed")
complete_plot <- complete_plot %>% mutate(Status =  factor(Status, levels = x)) %>% arrange(Status)
ggplot(complete_plot,aes(y=1)) +
geom_bar(aes(fill=Status), position="fill", width = 0.1,) +
scale_x_continuous(expand=expansion(0),labels = scales::percent_format()) +
theme(axis.title.y = element_blank(),
axis.ticks.y = element_blank(),
axis.text.y = element_blank()) +
ggtitle(gtitle) +
ylim( 0.9, 1.1) +
scale_fill_manual(values=c("#cd6600",
"#BF9000",
"#2E75B6"))
}
print_club_detail = function(total_xcl,shortname) {
xcl<-filter(total_xcl, ShortName==shortname)
tabl <- "
| Name        | Campus           |
|---------------:|:-------------|
| Website  | Wadd      |
| Email | eAdd      |
| President | pres |
"
tabl<-str_replace_all(tabl,"Name",xcl$Name)
tabl<-str_replace_all(tabl,"Campus",xcl$Campus)
tabl<-str_replace_all(tabl,"Wadd",xcl$Webpage)
tabl<-str_replace_all(tabl,"eAdd",xcl$Contact)
if (!is.na(xcl$President)) {
tabl<-str_replace_all(tabl,"pres",xcl$President)
} else {
tabl<-str_replace_all(tabl,"pres","TBD")
}
cat(tabl) # output the table in a format good for HTML/PDF/docx conversion
}
shortname="APL"
print_club_detail(total_xcl,shortname)
shortname="ECLIPSE"
print_club_detail(total_xcl,shortname)
