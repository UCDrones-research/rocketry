hc <- xcl$P_Interview
gnt <- data.frame(pc,fc,sc,tc,hc)
colnames(gnt) <- hs
xcl$E_Contact[,1]
xcl$E_Contact[1]
xcl$E_Contact[1,]
xcl$E_Contact
xcl$E_Contact[1]
gnt %>% add_row(Item="3",Group="EHS",Status=case_when(xcl$E_Interview==0 ~ "In Progress",xcl$E_Interview<=today_Date ~ "Completed", xcl$E_Interview>today_Date ~ "Planned"),Start=xcl$E_Contact[1],End=xcl$E_Interview[1])
xcl<-read_excel("UC_HPR.xlsx", sheet = "Contacts")
hs <- c("Item","Group","Status","Start","End")
pc <- c("1","2")
fc <- xcl$Name
sc <- case_when(xcl$P_Interview==0 ~ "In Progress",xcl$P_Interview<=today_Date ~ "Completed", xcl$P_Interview>today_Date ~ "Planned")
tc <- xcl$P_contact
hc <- xcl$P_Interview
gnt <- data.frame(pc,fc,sc,tc,hc)
colnames(gnt) <- hs
gnt %>% add_row(Item="3",Group="EHS",Status=case_when(xcl$E_Interview==0 ~ "In Progress",xcl$E_Interview<=today_Date ~ "Completed", xcl$E_Interview>today_Date ~ "Planned"),Start=xcl$E_Contact[1],End=xcl$E_Interview[1])
xcl<-read_excel("UC_HPR.xlsx", sheet = "Contacts")
hs <- c("Item","Group","Status","Start","End")
pc <- c("1","2")
fc <- xcl$Name
sc <- case_when(xcl$P_Interview==0 ~ "In Progress",xcl$P_Interview<=today_Date ~ "Completed", xcl$P_Interview>today_Date ~ "Planned")
tc <- xcl$P_contact
hc <- xcl$P_Interview
gnt <- data.frame(pc,fc,sc,tc,hc)
colnames(gnt) <- hs
gnt %>% add_row(Item="3",Group="EHS",Status=case_when(xcl$E_Interview[1]==0 ~ "In Progress",xcl$E_Interview[1]<=today_Date ~ "Completed", xcl$E_Interview[1]>today_Date ~ "Planned"),Start=xcl$E_Contact[1],End=xcl$E_Interview[1])
xcl<-read_excel("UC_HPR.xlsx", sheet = "Contacts")
hs <- c("Item","Group","Status","Start","End")
pc <- c("1","2")
fc <- xcl$Name
sc <- case_when(xcl$P_Interview==0 ~ "In Progress",xcl$P_Interview<=today_Date ~ "Completed", xcl$P_Interview>today_Date ~ "Planned")
tc <- xcl$P_contact
hc <- xcl$P_Interview
gnt <- data.frame(pc,fc,sc,tc,hc)
colnames(gnt) <- hs
gnt %>% add_row(Item="3",Group="EHS",Status=case_when(xcl$E_Interview[1]==0 ~ "In Progress",xcl$E_Interview[1]<=today_Date ~ "Completed", xcl$E_Interview[1]>today_Date ~ "Planned"),Start=xcl$E_Contact[1],End=xcl$E_Interview[1])
gnt %>% add_row(Item="4",Group="Risk",Status=case_when(xcl$R_Interview[1]==0 ~ "In Progress",xcl$R_Interview[1]<=today_Date ~ "Completed", xcl$R_Interview[1]>today_Date ~ "Planned"),Start=xcl$R_Contact[1],End=xcl$R_Interview[1])
xcl<-read_excel("UC_HPR.xlsx", sheet = "Contacts")
hs <- c("Item","Group","Status","Start","End")
pc <- c("1","2")
fc <- xcl$Name
sc <- case_when(xcl$P_Interview==0 ~ "In Progress",xcl$P_Interview<=today_Date ~ "Completed", xcl$P_Interview>today_Date ~ "Planned")
tc <- xcl$P_contact
hc <- xcl$P_Interview
gnt <- data.frame(pc,fc,sc,tc,hc)
colnames(gnt) <- hs
gnt %>% add_row(Item="3",Group="EHS",Status=case_when(xcl$E_Interview[1]==0 ~ "In Progress",xcl$E_Interview[1]<=today_Date ~ "Completed", xcl$E_Interview[1]>today_Date ~ "Planned"),Start=xcl$E_Contact[1],End=xcl$E_Interview[1])
gnt %>% add_row(Item="4",Group="Risk",Status=case_when(xcl$R_Interview[1]=="" ~ "In Progress",xcl$R_Interview[1]<=today_Date ~ "Completed", xcl$R_Interview[1]>today_Date ~ "Planned"),Start=xcl$R_Contact[1],End=xcl$R_Interview[1])
xcl<-read_excel("UC_HPR.xlsx", sheet = "Contacts")
hs <- c("Item","Group","Status","Start","End")
pc <- c("1","2")
fc <- xcl$Name
sc <- case_when(xcl$P_Interview==0 ~ "In Progress",xcl$P_Interview<=today_Date ~ "Completed", xcl$P_Interview>today_Date ~ "Planned")
tc <- xcl$P_contact
hc <- xcl$P_Interview
gnt <- data.frame(pc,fc,sc,tc,hc)
colnames(gnt) <- hs
gnt <- gnt %>% add_row(Item="3",Group="EHS",Status=case_when(xcl$E_Interview[1]==0 ~ "In Progress",xcl$E_Interview[1]<=today_Date ~ "Completed", xcl$E_Interview[1]>today_Date ~ "Planned"),Start=xcl$E_Contact[1],End=xcl$E_Interview[1])
gnt <- gnt %>% add_row(Item="4",Group="Risk",Status=case_when(xcl$R_Interview[1]=="" ~ "In Progress",xcl$R_Interview[1]<=today_Date ~ "Completed", xcl$R_Interview[1]>today_Date ~ "Planned"),Start=xcl$R_Contact[1],End=xcl$R_Interview[1])
xcl$R_Interview[1]
xcl<-read_excel("UC_HPR.xlsx", sheet = "Contacts")
hs <- c("Item","Group","Status","Start","End")
pc <- c("1","2")
fc <- xcl$Name
sc <- case_when(xcl$P_Interview==0 ~ "In Progress",xcl$P_Interview<=today_Date ~ "Completed", xcl$P_Interview>today_Date ~ "Planned")
tc <- xcl$P_contact
hc <- xcl$P_Interview
gnt <- data.frame(pc,fc,sc,tc,hc)
colnames(gnt) <- hs
gnt <- gnt %>% add_row(Item="3",Group="EHS",Status=case_when(xcl$E_Interview[1]==0 ~ "In Progress",xcl$E_Interview[1]<=today_Date ~ "Completed", xcl$E_Interview[1]>today_Date ~ "Planned"),Start=xcl$E_Contact[1],End=xcl$E_Interview[1])
gnt <- gnt %>% add_row(Item="4",Group="Risk",Status=case_when(xcl$R_Interview[1]==NA ~ "In Progress",xcl$R_Interview[1]<=today_Date ~ "Completed", xcl$R_Interview[1]>today_Date ~ "Planned"),Start=xcl$R_Contact[1],End=xcl$R_Interview[1])
xcl<-read_excel("UC_HPR.xlsx", sheet = "Contacts")
hs <- c("Item","Group","Status","Start","End")
pc <- c("1","2")
fc <- xcl$Name
sc <- case_when(xcl$P_Interview==0 ~ "In Progress",xcl$P_Interview<=today_Date ~ "Completed", xcl$P_Interview>today_Date ~ "Planned")
tc <- xcl$P_contact
hc <- xcl$P_Interview
gnt <- data.frame(pc,fc,sc,tc,hc)
colnames(gnt) <- hs
gnt <- gnt %>% add_row(Item="3",Group="EHS",Status=case_when(xcl$E_Interview[1]==0 ~ "In Progress",xcl$E_Interview[1]<=today_Date ~ "Completed", xcl$E_Interview[1]>today_Date ~ "Planned"),Start=xcl$E_Contact[1],End=xcl$E_Interview[1])
gnt <- gnt %>% add_row(Item="4",Group="Risk",Status=case_when(is.na(xcl$R_Interview[1]) ~ "In Progress",xcl$R_Interview[1]<=today_Date ~ "Completed", xcl$R_Interview[1]>today_Date ~ "Planned"),Start=xcl$R_Contact[1],End=xcl$R_Interview[1])
xcl<-read_excel("UC_HPR.xlsx", sheet = "Contacts")
hs <- c("Item","Group","Status","Start","End")
pc <- c("1","2")
fc <- xcl$Name
sc <- case_when(xcl$P_Interview==0 ~ "In Progress",xcl$P_Interview<=today_Date ~ "Completed", xcl$P_Interview>today_Date ~ "Planned")
tc <- xcl$P_contact
hc <- xcl$P_Interview
gnt <- data.frame(pc,fc,sc,tc,hc)
colnames(gnt) <- hs
gnt <- gnt %>% add_row(Item="3",Group="EHS",Status=case_when(is.na(xcl$R_Interview[1]) ~ "In Progress",xcl$E_Interview[1]<=today_Date ~ "Completed", xcl$E_Interview[1]>today_Date ~ "Planned"),Start=xcl$E_Contact[1],End=xcl$E_Interview[1])
gnt <- gnt %>% add_row(Item="4",Group="Risk",Status=case_when(is.na(xcl$R_Interview[1]) ~ "In Progress",xcl$R_Interview[1]<=today_Date ~ "Completed", xcl$R_Interview[1]>today_Date ~ "Planned"),Start=xcl$R_Contact[1],End=xcl$R_Interview[1])
xcl<-read_excel("UC_HPR.xlsx", sheet = "Contacts")
hs <- c("Item","Group","Status","Start","End")
pc <- c("1","2")
fc <- xcl$Name
sc <- case_when(xcl$P_Interview==0 ~ "In Progress",xcl$P_Interview<=today_Date ~ "Completed", xcl$P_Interview>today_Date ~ "Planned")
tc <- xcl$P_contact
hc <- xcl$P_Interview
gnt <- data.frame(pc,fc,sc,tc,hc)
colnames(gnt) <- hs
gnt <- gnt %>% add_row(Item="3",Group="EHS",Status=case_when(is.na(xcl$R_Interview[1]) ~ "In Progress",xcl$E_Interview[1]<=today_Date ~ "Completed", xcl$E_Interview[1]>today_Date ~ "Planned"),Start=xcl$E_Contact[1],End=xcl$E_Interview[1])
gnt <- gnt %>% add_row(Item="4",Group="Risk",Status=case_when(is.na(xcl$R_Interview[1]) ~ "In Progress",xcl$R_Interview[1]<=today_Date ~ "Completed", xcl$R_Interview[1]>today_Date ~ "Planned"),Start=xcl$R_Contact[1],End=xcl$R_Interview[1])
gnt <- gnt %>% add_row(Item="5",Group="Faculty",Status=case_when(is.na(xcl$F_Interview[1]) ~ "In Progress",xcl$F_Interview[1]<=today_Date ~ "Completed", xcl$F_Interview[1]>today_Date ~ "Planned"),Start=xcl$F_Contact[1],End=xcl$F_Interview[1])
length(hs)
hs
length(fc)
range(length(fc))
1:length(fc)
as.character(1:length(fc))
xcl<-read_excel("UC_HPR.xlsx", sheet = "Contacts")
hs <- c("Item","Group","Status","Start","End")
fc <- xcl$Name
pc <- as.character(1:length(fc))
sc <- case_when(xcl$P_Interview==0 ~ "In Progress",xcl$P_Interview<=today_Date ~ "Completed", xcl$P_Interview>today_Date ~ "Planned")
tc <- xcl$P_contact
hc <- xcl$P_Interview
gnt <- data.frame(pc,fc,sc,tc,hc)
colnames(gnt) <- hs
gnt <- gnt %>% add_row(Item="3",Group="EHS",Status=case_when(is.na(xcl$R_Interview[1]) ~ "In Progress",xcl$E_Interview[1]<=today_Date ~ "Completed", xcl$E_Interview[1]>today_Date ~ "Planned"),Start=xcl$E_Contact[1],End=xcl$E_Interview[1])
gnt <- gnt %>% add_row(Item="4",Group="Risk",Status=case_when(is.na(xcl$R_Interview[1]) ~ "In Progress",xcl$R_Interview[1]<=today_Date ~ "Completed", xcl$R_Interview[1]>today_Date ~ "Planned"),Start=xcl$R_Contact[1],End=xcl$R_Interview[1])
gnt <- gnt %>% add_row(Item="5",Group="Faculty",Status=case_when(is.na(xcl$F_Interview[1]) ~ "In Progress",xcl$F_Interview[1]<=today_Date ~ "Completed", xcl$F_Interview[1]>today_Date ~ "Planned"),Start=xcl$F_Contact[1],End=xcl$F_Interview[1])
gnt <- gnt %>% add_row(Item="6",Group="Dean of Engineering",Status=case_when(is.na(xcl$D_Interview[1]) ~ "In Progress",xcl$D_Interview[1]<=today_Date ~ "Completed", xcl$D_Interview[1]>today_Date ~ "Planned"),Start=xcl$D_Contact[1],End=xcl$D_Interview[1])
total_xcl<-read_excel("UC_HPR.xlsx", sheet = "Contacts")
xcl<-filter(total_xcl, Campus==campus)
total_xcl<-read_excel("UC_HPR.xlsx", sheet = "Contacts")
xcl<-filter(total_xcl, Campus=="Berkeley")
today_Date <- Sys.Date()
hs <- c("Item","Group","Status","Start","End")
fc <- xcl$Name
pc <- as.character(1:length(fc))
sc <- case_when(xcl$P_Interview==0 ~ "In Progress",xcl$P_Interview<=today_Date ~ "Completed", xcl$P_Interview>today_Date ~ "Planned")
tc <- xcl$P_contact
hc <- xcl$P_Interview
gnt <- data.frame(pc,fc,sc,tc,hc)
colnames(gnt) <- hs
gnt <- gnt %>% add_row(Item="3",Group="EHS",Status=case_when(is.na(xcl$R_Interview[1]) ~ "In Progress",xcl$E_Interview[1]<=today_Date ~ "Completed", xcl$E_Interview[1]>today_Date ~ "Planned"),Start=xcl$E_Contact[1],End=xcl$E_Interview[1])
gnt <- gnt %>% add_row(Item="4",Group="Risk",Status=case_when(is.na(xcl$R_Interview[1]) ~ "In Progress",xcl$R_Interview[1]<=today_Date ~ "Completed", xcl$R_Interview[1]>today_Date ~ "Planned"),Start=xcl$R_Contact[1],End=xcl$R_Interview[1])
gnt <- gnt %>% add_row(Item="5",Group="Faculty",Status=case_when(is.na(xcl$F_Interview[1]) ~ "In Progress",xcl$F_Interview[1]<=today_Date ~ "Completed", xcl$F_Interview[1]>today_Date ~ "Planned"),Start=xcl$F_Contact[1],End=xcl$F_Interview[1])
gnt <- gnt %>% add_row(Item="6",Group="Dean of Engineering",Status=case_when(is.na(xcl$D_Interview[1]) ~ "In Progress",xcl$D_Interview[1]<=today_Date ~ "Completed", xcl$D_Interview[1]>today_Date ~ "Planned"),Start=xcl$D_Contact[1],End=xcl$D_Interview[1])
start_Date <-as.Date(min(gsub("\\.","-",xcl$Start)))
end_Date <- as.Date(max(gsub("\\.","-",xcl$End)))+weeks(1)
xcl["End"][is.na(xcl["End"])]<-format(end_Date,"%Y.%m.%d")
total_xcl<-read_excel("UC_HPR.xlsx", sheet = "Contacts")
xcl<-filter(total_xcl, Campus=="Berkeley")
today_Date <- Sys.Date()
hs <- c("Item","Group","Status","Start","End")
fc <- xcl$Name
pc <- as.character(1:length(fc))
sc <- case_when(xcl$P_Interview==0 ~ "In Progress",xcl$P_Interview<=today_Date ~ "Completed", xcl$P_Interview>today_Date ~ "Planned")
tc <- xcl$P_contact
hc <- xcl$P_Interview
gnt <- data.frame(pc,fc,sc,tc,hc)
colnames(gnt) <- hs
gnt <- gnt %>% add_row(Item="3",Group="EHS",Status=case_when(is.na(xcl$R_Interview[1]) ~ "In Progress",xcl$E_Interview[1]<=today_Date ~ "Completed", xcl$E_Interview[1]>today_Date ~ "Planned"),Start=xcl$E_Contact[1],End=xcl$E_Interview[1])
gnt <- gnt %>% add_row(Item="4",Group="Risk",Status=case_when(is.na(xcl$R_Interview[1]) ~ "In Progress",xcl$R_Interview[1]<=today_Date ~ "Completed", xcl$R_Interview[1]>today_Date ~ "Planned"),Start=xcl$R_Contact[1],End=xcl$R_Interview[1])
gnt <- gnt %>% add_row(Item="5",Group="Faculty",Status=case_when(is.na(xcl$F_Interview[1]) ~ "In Progress",xcl$F_Interview[1]<=today_Date ~ "Completed", xcl$F_Interview[1]>today_Date ~ "Planned"),Start=xcl$F_Contact[1],End=xcl$F_Interview[1])
gnt <- gnt %>% add_row(Item="6",Group="Dean of Engineering",Status=case_when(is.na(xcl$D_Interview[1]) ~ "In Progress",xcl$D_Interview[1]<=today_Date ~ "Completed", xcl$D_Interview[1]>today_Date ~ "Planned"),Start=xcl$D_Contact[1],End=xcl$D_Interview[1])
start_Date <-as.Date(min(gsub("\\.","-",gnt$Start)))
end_Date <- as.Date(max(gsub("\\.","-",gnt$End)))+weeks(1)
gnt["End"][is.na(gnt["End"])]<-format(end_Date,"%Y.%m.%d")
gnt<-gnt[order(as.Date(gnt$Start,format="%Y.%m.%d")),]
is.na(gnt["End"])
format(end_Date,"%Y.%m.%d")
gnt$Start
total_xcl<-read_excel("UC_HPR.xlsx", sheet = "Contacts")
xcl<-filter(total_xcl, Campus=="Berkeley")
today_Date <- Sys.Date()
hs <- c("Item","Group","Status","Start","End")
fc <- xcl$Name
pc <- as.character(1:length(fc))
sc <- case_when(xcl$P_Interview==0 ~ "In Progress",xcl$P_Interview<=today_Date ~ "Completed", xcl$P_Interview>today_Date ~ "Planned")
tc <- xcl$P_contact
hc <- xcl$P_Interview
gnt <- data.frame(pc,fc,sc,tc,hc)
colnames(gnt) <- hs
gnt <- gnt %>% add_row(Item="3",Group="EHS",Status=case_when(is.na(xcl$R_Interview[1]) ~ "In Progress",xcl$E_Interview[1]<=today_Date ~ "Completed", xcl$E_Interview[1]>today_Date ~ "Planned"),Start=xcl$E_Contact[1],End=xcl$E_Interview[1])
gnt <- gnt %>% add_row(Item="4",Group="Risk",Status=case_when(is.na(xcl$R_Interview[1]) ~ "In Progress",xcl$R_Interview[1]<=today_Date ~ "Completed", xcl$R_Interview[1]>today_Date ~ "Planned"),Start=xcl$R_Contact[1],End=xcl$R_Interview[1])
gnt <- gnt %>% add_row(Item="5",Group="Faculty",Status=case_when(is.na(xcl$F_Interview[1]) ~ "In Progress",xcl$F_Interview[1]<=today_Date ~ "Completed", xcl$F_Interview[1]>today_Date ~ "Planned"),Start=xcl$F_Contact[1],End=xcl$F_Interview[1])
gnt <- gnt %>% add_row(Item="6",Group="Dean of Engineering",Status=case_when(is.na(xcl$D_Interview[1]) ~ "In Progress",xcl$D_Interview[1]<=today_Date ~ "Completed", xcl$D_Interview[1]>today_Date ~ "Planned"),Start=xcl$D_Contact[1],End=xcl$D_Interview[1])
start_Date <-as.Date(min(gsub("\\.","-",na.omit(gnt$Start))))
end_Date <- as.Date(max(gsub("\\.","-",na.omit(gnt$End))))+weeks(1)
gnt["End"][is.na(gnt["End"])]<-format(end_Date,"%Y.%m.%d")
format(end_Date,"%Y.%m.%d")
is.na(gnt["End"])
gnt["End"][is.na(gnt["End"])]<-format(end_Date,"%Y.%m.%d")
gnt["End"][is.na(gnt["End"])]<-"0"
gnt["End"][is.na(gnt["End"])]<-0
gnt["End"][is.na(gnt["End"])]<-end_Date
total_xcl<-read_excel("UC_HPR.xlsx", sheet = "Contacts")
xcl<-filter(total_xcl, Campus=="Berkeley")
today_Date <- Sys.Date()
hs <- c("Item","Group","Status","Start","End")
fc <- xcl$Name
pc <- as.character(1:length(fc))
sc <- case_when(xcl$P_Interview==0 ~ "In Progress",xcl$P_Interview<=today_Date ~ "Completed", xcl$P_Interview>today_Date ~ "Planned")
tc <- xcl$P_contact
hc <- xcl$P_Interview
gnt <- data.frame(pc,fc,sc,tc,hc)
colnames(gnt) <- hs
gnt <- gnt %>% add_row(Item="3",Group="EHS",Status=case_when(is.na(xcl$R_Interview[1]) ~ "In Progress",xcl$E_Interview[1]<=today_Date ~ "Completed", xcl$E_Interview[1]>today_Date ~ "Planned"),Start=xcl$E_Contact[1],End=xcl$E_Interview[1])
gnt <- gnt %>% add_row(Item="4",Group="Risk",Status=case_when(is.na(xcl$R_Interview[1]) ~ "In Progress",xcl$R_Interview[1]<=today_Date ~ "Completed", xcl$R_Interview[1]>today_Date ~ "Planned"),Start=xcl$R_Contact[1],End=xcl$R_Interview[1])
gnt <- gnt %>% add_row(Item="5",Group="Faculty",Status=case_when(is.na(xcl$F_Interview[1]) ~ "In Progress",xcl$F_Interview[1]<=today_Date ~ "Completed", xcl$F_Interview[1]>today_Date ~ "Planned"),Start=xcl$F_Contact[1],End=xcl$F_Interview[1])
gnt <- gnt %>% add_row(Item="6",Group="Dean of Engineering",Status=case_when(is.na(xcl$D_Interview[1]) ~ "In Progress",xcl$D_Interview[1]<=today_Date ~ "Completed", xcl$D_Interview[1]>today_Date ~ "Planned"),Start=xcl$D_Contact[1],End=xcl$D_Interview[1])
start_Date <-as.Date(min(gsub("\\.","-",na.omit(gnt$Start))))
end_Date <- as.Date(max(gsub("\\.","-",na.omit(gnt$End))))+weeks(1)
gnt["End"][is.na(gnt["End"])]<-end_Date
gnt<-gnt[order(as.Date(gnt$Start,format="%Y.%m.%d")),]
total_xcl<-read_excel("UC_HPR.xlsx", sheet = "Contacts")
xcl<-filter(total_xcl, Campus=="Berkeley")
today_Date <- Sys.Date()
hs <- c("Item","Group","Status","Start","End")
fc <- xcl$Name
pc <- as.character(1:length(fc))
sc <- case_when(xcl$P_Interview==0 ~ "In Progress",xcl$P_Interview<=today_Date ~ "Completed", xcl$P_Interview>today_Date ~ "Planned")
tc <- xcl$P_contact
hc <- xcl$P_Interview
gnt <- data.frame(pc,fc,sc,tc,hc)
colnames(gnt) <- hs
gnt <- gnt %>% add_row(Item="3",Group="EHS",Status=case_when(is.na(xcl$R_Interview[1]) ~ "In Progress",xcl$E_Interview[1]<=today_Date ~ "Completed", xcl$E_Interview[1]>today_Date ~ "Planned"),Start=xcl$E_Contact[1],End=xcl$E_Interview[1])
gnt <- gnt %>% add_row(Item="4",Group="Risk",Status=case_when(is.na(xcl$R_Interview[1]) ~ "In Progress",xcl$R_Interview[1]<=today_Date ~ "Completed", xcl$R_Interview[1]>today_Date ~ "Planned"),Start=xcl$R_Contact[1],End=xcl$R_Interview[1])
gnt <- gnt %>% add_row(Item="5",Group="Faculty",Status=case_when(is.na(xcl$F_Interview[1]) ~ "In Progress",xcl$F_Interview[1]<=today_Date ~ "Completed", xcl$F_Interview[1]>today_Date ~ "Planned"),Start=xcl$F_Contact[1],End=xcl$F_Interview[1])
gnt <- gnt %>% add_row(Item="6",Group="Dean of Engineering",Status=case_when(is.na(xcl$D_Interview[1]) ~ "In Progress",xcl$D_Interview[1]<=today_Date ~ "Completed", xcl$D_Interview[1]>today_Date ~ "Planned"),Start=xcl$D_Contact[1],End=xcl$D_Interview[1])
start_Date <-as.Date(min(gsub("\\.","-",na.omit(gnt$Start))))
end_Date <- as.Date(max(gsub("\\.","-",na.omit(gnt$End))))+weeks(1)
gantt_plot <- filter(total_xcl, is.na(gnt["End"]))
total_xcl<-read_excel("UC_HPR.xlsx", sheet = "Contacts")
xcl<-filter(total_xcl, Campus=="Berkeley")
today_Date <- Sys.Date()
hs <- c("Item","Group","Status","Start","End")
fc <- xcl$Name
pc <- as.character(1:length(fc))
sc <- case_when(xcl$P_Interview==0 ~ "In Progress",xcl$P_Interview<=today_Date ~ "Completed", xcl$P_Interview>today_Date ~ "Planned")
tc <- xcl$P_contact
hc <- xcl$P_Interview
gnt <- data.frame(pc,fc,sc,tc,hc)
colnames(gnt) <- hs
gnt <- gnt %>% add_row(Item="3",Group="EHS",Status=case_when(is.na(xcl$R_Interview[1]) ~ "In Progress",xcl$E_Interview[1]<=today_Date ~ "Completed", xcl$E_Interview[1]>today_Date ~ "Planned"),Start=xcl$E_Contact[1],End=xcl$E_Interview[1])
gnt <- gnt %>% add_row(Item="4",Group="Risk",Status=case_when(is.na(xcl$R_Interview[1]) ~ "In Progress",xcl$R_Interview[1]<=today_Date ~ "Completed", xcl$R_Interview[1]>today_Date ~ "Planned"),Start=xcl$R_Contact[1],End=xcl$R_Interview[1])
gnt <- gnt %>% add_row(Item="5",Group="Faculty",Status=case_when(is.na(xcl$F_Interview[1]) ~ "In Progress",xcl$F_Interview[1]<=today_Date ~ "Completed", xcl$F_Interview[1]>today_Date ~ "Planned"),Start=xcl$F_Contact[1],End=xcl$F_Interview[1])
gnt <- gnt %>% add_row(Item="6",Group="Dean of Engineering",Status=case_when(is.na(xcl$D_Interview[1]) ~ "In Progress",xcl$D_Interview[1]<=today_Date ~ "Completed", xcl$D_Interview[1]>today_Date ~ "Planned"),Start=xcl$D_Contact[1],End=xcl$D_Interview[1])
start_Date <-as.Date(min(gsub("\\.","-",na.omit(gnt$Start))))
end_Date <- as.Date(max(gsub("\\.","-",na.omit(gnt$End))))+weeks(1)
gantt_plot <- gnt %>% filter(if_any(everything(), is.na))
gantt_plot["End"][is.na(gantt_plot["End"])]<-end_Date
gantt_plot<-gantt_plot[order(as.Date(gantt_plot$Start,format="%Y.%m.%d")),]
View(gantt_plot)
total_xcl<-read_excel("UC_HPR.xlsx", sheet = "Contacts")
xcl<-filter(total_xcl, Campus=="Berkeley")
today_Date <- Sys.Date()
hs <- c("Item","Group","Status","Start","End")
fc <- xcl$Name
pc <- as.character(1:length(fc))
sc <- case_when(xcl$P_Interview==0 ~ "In Progress",xcl$P_Interview<=today_Date ~ "Completed", xcl$P_Interview>today_Date ~ "Planned")
tc <- xcl$P_contact
hc <- xcl$P_Interview
gnt <- data.frame(pc,fc,sc,tc,hc)
colnames(gnt) <- hs
gnt <- gnt %>% add_row(Item="3",Group="EHS",Status=case_when(is.na(xcl$R_Interview[1]) ~ "In Progress",xcl$E_Interview[1]<=today_Date ~ "Completed", xcl$E_Interview[1]>today_Date ~ "Planned"),Start=xcl$E_Contact[1],End=xcl$E_Interview[1])
gnt <- gnt %>% add_row(Item="4",Group="Risk",Status=case_when(is.na(xcl$R_Interview[1]) ~ "In Progress",xcl$R_Interview[1]<=today_Date ~ "Completed", xcl$R_Interview[1]>today_Date ~ "Planned"),Start=xcl$R_Contact[1],End=xcl$R_Interview[1])
gnt <- gnt %>% add_row(Item="5",Group="Faculty",Status=case_when(is.na(xcl$F_Interview[1]) ~ "In Progress",xcl$F_Interview[1]<=today_Date ~ "Completed", xcl$F_Interview[1]>today_Date ~ "Planned"),Start=xcl$F_Contact[1],End=xcl$F_Interview[1])
gnt <- gnt %>% add_row(Item="6",Group="Dean of Engineering",Status=case_when(is.na(xcl$D_Interview[1]) ~ "In Progress",xcl$D_Interview[1]<=today_Date ~ "Completed", xcl$D_Interview[1]>today_Date ~ "Planned"),Start=xcl$D_Contact[1],End=xcl$D_Interview[1])
start_Date <-as.Date(min(gsub("\\.","-",na.omit(gnt$Start))))
end_Date <- as.Date(max(gsub("\\.","-",na.omit(gnt$End))))+weeks(1)
gantt_plot <- na.omit(gnt)
gantt_plot["End"][is.na(gantt_plot["End"])]<-end_Date
gantt_plot<-gantt_plot[order(as.Date(gantt_plot$Start,format="%Y.%m.%d")),]
total_xcl<-read_excel("UC_HPR.xlsx", sheet = "Contacts")
campus = "Berkeley"
xcl<-filter(total_xcl, Campus==campus)
today_Date <- Sys.Date()
hs <- c("Item","Group","Status","Start","End")
fc <- xcl$Name
pc <- as.character(1:length(fc))
sc <- case_when(xcl$P_Interview==0 ~ "In Progress",xcl$P_Interview<=today_Date ~ "Completed", xcl$P_Interview>today_Date ~ "Planned")
tc <- xcl$P_contact
hc <- xcl$P_Interview
gnt <- data.frame(pc,fc,sc,tc,hc)
colnames(gnt) <- hs
gnt <- gnt %>% add_row(Item="3",Group="EHS",Status=case_when(is.na(xcl$R_Interview[1]) ~ "In Progress",xcl$E_Interview[1]<=today_Date ~ "Completed", xcl$E_Interview[1]>today_Date ~ "Planned"),Start=xcl$E_Contact[1],End=xcl$E_Interview[1])
gnt <- gnt %>% add_row(Item="4",Group="Risk",Status=case_when(is.na(xcl$R_Interview[1]) ~ "In Progress",xcl$R_Interview[1]<=today_Date ~ "Completed", xcl$R_Interview[1]>today_Date ~ "Planned"),Start=xcl$R_Contact[1],End=xcl$R_Interview[1])
gnt <- gnt %>% add_row(Item="5",Group="Faculty",Status=case_when(is.na(xcl$F_Interview[1]) ~ "In Progress",xcl$F_Interview[1]<=today_Date ~ "Completed", xcl$F_Interview[1]>today_Date ~ "Planned"),Start=xcl$F_Contact[1],End=xcl$F_Interview[1])
gnt <- gnt %>% add_row(Item="6",Group="Dean of Engineering",Status=case_when(is.na(xcl$D_Interview[1]) ~ "In Progress",xcl$D_Interview[1]<=today_Date ~ "Completed", xcl$D_Interview[1]>today_Date ~ "Planned"),Start=xcl$D_Contact[1],End=xcl$D_Interview[1])
start_Date <-as.Date(min(gsub("\\.","-",na.omit(gnt$Start))))
end_Date <- as.Date(max(gsub("\\.","-",na.omit(gnt$End))))+weeks(1)
gantt_plot <- na.omit(gnt)
gantt_plot["End"][is.na(gantt_plot["End"])]<-end_Date
gantt_plot<-gantt_plot[order(as.Date(gantt_plot$Start,format="%Y.%m.%d")),]
acts<-unique(as.character(gantt_plot$Group))
els <-unique(as.character(gantt_plot$Status))
actcols <- c("#548235", "#2E75B6", "#BF9000", "#7030A0", "#cd6600")
g.gantt <- gather(gantt, "state", "date", 3:4) %>% mutate(date = as.Date(date, "%Y.%m.%d"), Group=factor(Group, acts[length(acts):1]), Status=factor(Status, els))
total_xcl<-read_excel("UC_HPR.xlsx", sheet = "Contacts")
campus = "Berkeley"
xcl<-filter(total_xcl, Campus==campus)
today_Date <- Sys.Date()
hs <- c("Item","Group","Status","Start","End")
fc <- xcl$Name
pc <- as.character(1:length(fc))
sc <- case_when(xcl$P_Interview==0 ~ "In Progress",xcl$P_Interview<=today_Date ~ "Completed", xcl$P_Interview>today_Date ~ "Planned")
tc <- xcl$P_contact
hc <- xcl$P_Interview
gnt <- data.frame(pc,fc,sc,tc,hc)
colnames(gnt) <- hs
gnt <- gnt %>% add_row(Item="3",Group="EHS",Status=case_when(is.na(xcl$R_Interview[1]) ~ "In Progress",xcl$E_Interview[1]<=today_Date ~ "Completed", xcl$E_Interview[1]>today_Date ~ "Planned"),Start=xcl$E_Contact[1],End=xcl$E_Interview[1])
gnt <- gnt %>% add_row(Item="4",Group="Risk",Status=case_when(is.na(xcl$R_Interview[1]) ~ "In Progress",xcl$R_Interview[1]<=today_Date ~ "Completed", xcl$R_Interview[1]>today_Date ~ "Planned"),Start=xcl$R_Contact[1],End=xcl$R_Interview[1])
gnt <- gnt %>% add_row(Item="5",Group="Faculty",Status=case_when(is.na(xcl$F_Interview[1]) ~ "In Progress",xcl$F_Interview[1]<=today_Date ~ "Completed", xcl$F_Interview[1]>today_Date ~ "Planned"),Start=xcl$F_Contact[1],End=xcl$F_Interview[1])
gnt <- gnt %>% add_row(Item="6",Group="Dean of Engineering",Status=case_when(is.na(xcl$D_Interview[1]) ~ "In Progress",xcl$D_Interview[1]<=today_Date ~ "Completed", xcl$D_Interview[1]>today_Date ~ "Planned"),Start=xcl$D_Contact[1],End=xcl$D_Interview[1])
start_Date <-as.Date(min(gsub("\\.","-",na.omit(gnt$Start))))
end_Date <- as.Date(max(gsub("\\.","-",na.omit(gnt$End))))+weeks(1)
gantt_plot <- na.omit(gnt)
gantt_plot["End"][is.na(gantt_plot["End"])]<-end_Date
gantt_plot<-gantt_plot[order(as.Date(gantt_plot$Start,format="%Y.%m.%d")),]
acts<-unique(as.character(gantt_plot$Group))
els <-unique(as.character(gantt_plot$Status))
actcols <- c("#548235", "#2E75B6", "#BF9000", "#7030A0", "#cd6600")
g.gantt_plot <- gather(gantt_plot, "state", "date", 3:4) %>% mutate(date = as.Date(date, "%Y.%m.%d"), Group=factor(Group, acts[length(acts):1]), Status=factor(Status, els))
total_xcl<-read_excel("UC_HPR.xlsx", sheet = "Contacts")
campus = "Berkeley"
xcl<-filter(total_xcl, Campus==campus)
today_Date <- Sys.Date()
hs <- c("Item","Group","Status","Start","End")
fc <- xcl$Name
pc <- as.character(1:length(fc))
sc <- case_when(xcl$P_Interview==0 ~ "In Progress",xcl$P_Interview<=today_Date ~ "Completed", xcl$P_Interview>today_Date ~ "Planned")
tc <- xcl$P_contact
hc <- xcl$P_Interview
gnt <- data.frame(pc,fc,sc,tc,hc)
colnames(gnt) <- hs
gnt <- gnt %>% add_row(Item="3",Group="EHS",Status=case_when(is.na(xcl$R_Interview[1]) ~ "In Progress",xcl$E_Interview[1]<=today_Date ~ "Completed", xcl$E_Interview[1]>today_Date ~ "Planned"),Start=xcl$E_Contact[1],End=xcl$E_Interview[1])
gnt <- gnt %>% add_row(Item="4",Group="Risk",Status=case_when(is.na(xcl$R_Interview[1]) ~ "In Progress",xcl$R_Interview[1]<=today_Date ~ "Completed", xcl$R_Interview[1]>today_Date ~ "Planned"),Start=xcl$R_Contact[1],End=xcl$R_Interview[1])
gnt <- gnt %>% add_row(Item="5",Group="Faculty",Status=case_when(is.na(xcl$F_Interview[1]) ~ "In Progress",xcl$F_Interview[1]<=today_Date ~ "Completed", xcl$F_Interview[1]>today_Date ~ "Planned"),Start=xcl$F_Contact[1],End=xcl$F_Interview[1])
gnt <- gnt %>% add_row(Item="6",Group="Dean of Engineering",Status=case_when(is.na(xcl$D_Interview[1]) ~ "In Progress",xcl$D_Interview[1]<=today_Date ~ "Completed", xcl$D_Interview[1]>today_Date ~ "Planned"),Start=xcl$D_Contact[1],End=xcl$D_Interview[1])
start_Date <-as.Date(min(gsub("\\.","-",na.omit(gnt$Start))))
end_Date <- as.Date(max(gsub("\\.","-",na.omit(gnt$End))))+weeks(1)
gantt_plot <- na.omit(gnt)
gantt_plot["End"][is.na(gantt_plot["End"])]<-end_Date
gantt_plot<-gantt_plot[order(as.Date(gantt_plot$Start,format="%Y.%m.%d")),]
acts<-unique(as.character(gantt_plot$Group))
els <-unique(as.character(gantt_plot$Status))
actcols <- c("#548235", "#2E75B6", "#BF9000", "#7030A0", "#cd6600")
g.gantt_plot <- gather(gantt_plot, "state", "date", 2:3) %>% mutate(date = as.Date(date, "%Y.%m.%d"), Group=factor(Group, acts[length(acts):1]), Status=factor(Status, els))
gather(gantt_plot, "state", "date", 2:3)
gather(gantt_plot, "state", "date", 1:3)
gather(gantt_plot, "state", "date", 3:4)
View(g.gantt)
gather(gantt_plot, "state", "date", 2:3)
gather(gantt_plot, "state", "date", 3:4)
gather(gantt_plot, "state", "date", 4:5)
total_xcl<-read_excel("UC_HPR.xlsx", sheet = "Contacts")
campus = "Berkeley"
xcl<-filter(total_xcl, Campus==campus)
today_Date <- Sys.Date()
hs <- c("Item","Group","Status","Start","End")
fc <- xcl$Name
pc <- as.character(1:length(fc))
sc <- case_when(xcl$P_Interview==0 ~ "In Progress",xcl$P_Interview<=today_Date ~ "Completed", xcl$P_Interview>today_Date ~ "Planned")
tc <- xcl$P_contact
hc <- xcl$P_Interview
gnt <- data.frame(pc,fc,sc,tc,hc)
colnames(gnt) <- hs
gnt <- gnt %>% add_row(Item="3",Group="EHS",Status=case_when(is.na(xcl$R_Interview[1]) ~ "In Progress",xcl$E_Interview[1]<=today_Date ~ "Completed", xcl$E_Interview[1]>today_Date ~ "Planned"),Start=xcl$E_Contact[1],End=xcl$E_Interview[1])
gnt <- gnt %>% add_row(Item="4",Group="Risk",Status=case_when(is.na(xcl$R_Interview[1]) ~ "In Progress",xcl$R_Interview[1]<=today_Date ~ "Completed", xcl$R_Interview[1]>today_Date ~ "Planned"),Start=xcl$R_Contact[1],End=xcl$R_Interview[1])
gnt <- gnt %>% add_row(Item="5",Group="Faculty",Status=case_when(is.na(xcl$F_Interview[1]) ~ "In Progress",xcl$F_Interview[1]<=today_Date ~ "Completed", xcl$F_Interview[1]>today_Date ~ "Planned"),Start=xcl$F_Contact[1],End=xcl$F_Interview[1])
gnt <- gnt %>% add_row(Item="6",Group="Dean of Engineering",Status=case_when(is.na(xcl$D_Interview[1]) ~ "In Progress",xcl$D_Interview[1]<=today_Date ~ "Completed", xcl$D_Interview[1]>today_Date ~ "Planned"),Start=xcl$D_Contact[1],End=xcl$D_Interview[1])
start_Date <-as.Date(min(gsub("\\.","-",na.omit(gnt$Start))))
end_Date <- as.Date(max(gsub("\\.","-",na.omit(gnt$End))))+weeks(1)
gantt_plot <- na.omit(gnt)
gantt_plot["End"][is.na(gantt_plot["End"])]<-end_Date
gantt_plot<-gantt_plot[order(as.Date(gantt_plot$Start,format="%Y.%m.%d")),]
acts<-unique(as.character(gantt_plot$Group))
els <-unique(as.character(gantt_plot$Status))
actcols <- c("#548235", "#2E75B6", "#BF9000", "#7030A0", "#cd6600")
g.gantt_plot <- gather(gantt_plot, "state", "date", 4:5) %>% mutate(date = as.Date(date, "%Y.%m.%d"), Group=factor(Group, acts[length(acts):1]), Status=factor(Status, els))
ggplot(g.gantt_plot, aes(date, Group, colour = Status, group=Item)) +
geom_line(linewidth = 10) +
scale_color_manual(values=actcols, name="Key") +
labs(x="Date", y=NULL, title=campus) +
scale_x_date(date_labels = "%b %d")+
theme_gray(base_size=14)+
annotate(geom = "vline",
x = today_Date,
xintercept = today_Date,
linetype = "dashed",
colour = "red",
linewidth = 1.5)
total_xcl<-read_excel("UC_HPR.xlsx", sheet = "Contacts")
campus = "Berkeley"
xcl<-filter(total_xcl, Campus==campus)
today_Date <- Sys.Date()
hs <- c("Item","Group","Status","Start","End")
fc <- xcl$ShortName
pc <- as.character(1:length(fc))
sc <- case_when(xcl$P_Interview==0 ~ "In Progress",xcl$P_Interview<=today_Date ~ "Completed", xcl$P_Interview>today_Date ~ "Planned")
tc <- xcl$P_contact
hc <- xcl$P_Interview
gnt <- data.frame(pc,fc,sc,tc,hc)
colnames(gnt) <- hs
gnt <- gnt %>% add_row(Item="3",Group="EHS",Status=case_when(is.na(xcl$R_Interview[1]) ~ "In Progress",xcl$E_Interview[1]<=today_Date ~ "Completed", xcl$E_Interview[1]>today_Date ~ "Planned"),Start=xcl$E_Contact[1],End=xcl$E_Interview[1])
gnt <- gnt %>% add_row(Item="4",Group="Risk",Status=case_when(is.na(xcl$R_Interview[1]) ~ "In Progress",xcl$R_Interview[1]<=today_Date ~ "Completed", xcl$R_Interview[1]>today_Date ~ "Planned"),Start=xcl$R_Contact[1],End=xcl$R_Interview[1])
gnt <- gnt %>% add_row(Item="5",Group="Faculty",Status=case_when(is.na(xcl$F_Interview[1]) ~ "In Progress",xcl$F_Interview[1]<=today_Date ~ "Completed", xcl$F_Interview[1]>today_Date ~ "Planned"),Start=xcl$F_Contact[1],End=xcl$F_Interview[1])
gnt <- gnt %>% add_row(Item="6",Group="Dean of Engineering",Status=case_when(is.na(xcl$D_Interview[1]) ~ "In Progress",xcl$D_Interview[1]<=today_Date ~ "Completed", xcl$D_Interview[1]>today_Date ~ "Planned"),Start=xcl$D_Contact[1],End=xcl$D_Interview[1])
start_Date <-as.Date(min(gsub("\\.","-",na.omit(gnt$Start))))
end_Date <- as.Date(max(gsub("\\.","-",na.omit(gnt$End))))+weeks(1)
gantt_plot <- na.omit(gnt)
gantt_plot["End"][is.na(gantt_plot["End"])]<-end_Date
gantt_plot<-gantt_plot[order(as.Date(gantt_plot$Start,format="%Y.%m.%d")),]
acts<-unique(as.character(gantt_plot$Group))
els <-unique(as.character(gantt_plot$Status))
actcols <- c("#548235", "#2E75B6", "#BF9000", "#7030A0", "#cd6600")
g.gantt_plot <- gather(gantt_plot, "state", "date", 4:5) %>% mutate(date = as.Date(date, "%Y.%m.%d"), Group=factor(Group, acts[length(acts):1]), Status=factor(Status, els))
ggplot(g.gantt_plot, aes(date, Group, colour = Status, group=Item)) +
geom_line(linewidth = 10) +
scale_color_manual(values=actcols, name="Key") +
labs(x="Date", y=NULL, title=campus) +
scale_x_date(date_labels = "%b %d")+
theme_gray(base_size=14)+
annotate(geom = "vline",
x = today_Date,
xintercept = today_Date,
linetype = "dashed",
colour = "red",
linewidth = 1.5)
questions <- data.frame(Person = 1:2)
View(questions)
for (i in 1:2) {
questions[[paste0('Q',i)]] <- sample(1:5, 2, replace=TRUE)
}
View(questions)
for (i in 1:2) {
questions[[paste0('Q',i)]] <- sample(1:5, 5, replace=TRUE)
}
questions <- data.frame(Person = 1:2)
for (i in 1:2) {
+     questions[[paste0('Q',i)]] <- sample(1:5, 5, replace=TRUE)
+ }
for (i in 1:2) {
questions[[paste0('Q',i)]] <- sample(1:5, 2, replace=TRUE)
}
questions <- data.frame(Person = 1:5)
for (i in 1:5) {
+     questions[[paste0('Q',i)]] <- sample(1:5, 5, replace=TRUE)
+ }
for (i in 1:5) {
questions[[paste0('Q',i)]] <- sample(1:5, 5, replace=TRUE)
}
questions <- questions %>% gather(key='Question_num', value='Answer', -Person)
questions$Answer <- factor(questions$Answer,
levels=1:5,
labels=c('Approve','Slightly Approve','Neutral','Slightly Disapprove','Disapprove'))
ggplot(questions, aes(x=Question_num)) +
geom_bar(aes(fill=Answer))
complete_plot <- subset(gnt,select=c("Group","Status"))
View(complete_plot)
ggplot(complete_plot,aes()) + geom_bar(aes(fill=Status))
ggplot(complete_plot,aes(y)) + geom_bar(aes(fill=Status))
ggplot(complete_plot,aes(y=Status)) + geom_bar(aes(fill=Status))
ggplot(complete_plot,aes(y=1)) + geom_bar(aes(fill=Status))
total_xcl<-read_excel("UC_HPR.xlsx", sheet = "Contacts")
campus = "Berkeley"
xcl<-filter(total_xcl, Campus==campus)
today_Date <- Sys.Date()
hs <- c("Item","Group","Status","Start","End")
fc <- xcl$ShortName
pc <- as.character(1:length(fc))
sc <- case_when(xcl$P_Interview==0 ~ "In Progress",xcl$P_Interview<=today_Date ~ "Completed", xcl$P_Interview>today_Date ~ "Planned")
tc <- xcl$P_contact
hc <- xcl$P_Interview
gnt <- data.frame(pc,fc,sc,tc,hc)
colnames(gnt) <- hs
gnt <- gnt %>% add_row(Item="3",Group="EHS",Status=case_when(is.na(xcl$R_Interview[1]) ~ "In Progress",xcl$E_Interview[1]<=today_Date ~ "Completed", xcl$E_Interview[1]>today_Date ~ "Planned"),Start=xcl$E_Contact[1],End=xcl$E_Interview[1])
gnt <- gnt %>% add_row(Item="4",Group="Risk",Status=case_when(is.na(xcl$R_Interview[1]) ~ "In Progress",xcl$R_Interview[1]<=today_Date ~ "Completed", xcl$R_Interview[1]>today_Date ~ "Planned"),Start=xcl$R_Contact[1],End=xcl$R_Interview[1])
gnt <- gnt %>% add_row(Item="5",Group="Faculty",Status=case_when(is.na(xcl$F_Interview[1]) ~ "In Progress",xcl$F_Interview[1]<=today_Date ~ "Completed", xcl$F_Interview[1]>today_Date ~ "Planned"),Start=xcl$F_Contact[1],End=xcl$F_Interview[1])
gnt <- gnt %>% add_row(Item="6",Group="Dean of Engineering",Status=case_when(is.na(xcl$D_Interview[1]) ~ "In Progress",xcl$D_Interview[1]<=today_Date ~ "Completed", xcl$D_Interview[1]>today_Date ~ "Planned"),Start=xcl$D_Contact[1],End=xcl$D_Interview[1])
start_Date <-as.Date(min(gsub("\\.","-",na.omit(gnt$Start))))
end_Date <- as.Date(max(gsub("\\.","-",na.omit(gnt$End))))+weeks(1)
gantt_plot <- na.omit(gnt)
gantt_plot["End"][is.na(gantt_plot["End"])]<-end_Date
gantt_plot<-gantt_plot[order(as.Date(gantt_plot$Start,format="%Y.%m.%d")),]
acts<-unique(as.character(gantt_plot$Group))
els <-unique(as.character(gantt_plot$Status))
actcols <- c("#548235", "#2E75B6", "#BF9000", "#7030A0", "#cd6600")
g.gantt_plot <- gather(gantt_plot, "state", "date", 4:5) %>% mutate(date = as.Date(date, "%Y.%m.%d"), Group=factor(Group, acts[length(acts):1]), Status=factor(Status, els))
ggplot(g.gantt_plot, aes(date, Group, colour = Status, group=Item)) +
geom_line(linewidth = 10) +
scale_color_manual(values=actcols, name="Key") +
labs(x="Date", y=NULL, title=campus) +
scale_x_date(date_labels = "%b %d")+
theme_gray(base_size=14)+
annotate(geom = "vline",
x = today_Date,
xintercept = today_Date,
linetype = "dashed",
colour = "red",
linewidth = 1.5)
complete_plot <- subset(gnt,select=c("Group","Status"))
ggplot(complete_plot,aes(y=1)) +
geom_bar(aes(fill=Status)) +
scale_x_continuous(expand=expansion(0),labels = scales::percent_format())
complete_plot <- subset(gnt,select=c("Group","Status"))
ggplot(complete_plot,aes(y=1)) +
geom_bar(aes(fill=Status)) +
scale_x_continuous(expand=expansion(0),labels = scales::percent_format())
complete_plot <- subset(gnt,select=c("Group","Status"))
ggplot(complete_plot,aes(y=1)) +
geom_bar(aes(fill=Status), position="fill") +
scale_x_continuous(expand=expansion(0),labels = scales::percent_format())
View(questions)
